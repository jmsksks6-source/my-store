import React, { useEffect, useMemo, useState } from "react"; import { createRoot } from "react-dom/client"; import bcrypt from "bcryptjs"; import { v4 as uuidv4 } from "uuid";

/* TITAN.OS - React Single File (RTL Arabic)

Ù…ÙŠØ²Ø§Øª Ø¹Ø§Ù„Ù…ÙŠØ©: PWA hooks, Accessible, RTL, Search, Filters, Cart (quantity), Checkout validation, Admin (hashed PIN + rate limit), Orders management, CSV export, localStorage persistence, graceful EmailJS fallback and error handling.


Ù…Ù„Ø§Ø­Ø¸Ø©:

ÙŠØ­ØªØ§Ø¬ Ù…Ø´Ø±ÙˆØ¹ React + Tailwind setup Ù„ØªØ¹Ù…Ù„ Ø§Ù„Ø³ØªØ§ÙŠÙ„Ø§Øª. (Tailwind Ù…ÙÙØªØ±Ø¶ Ù…ØªÙˆÙØ±)

ÙŠØªØ·Ù„Ø¨ ØªØ«Ø¨ÙŠØª Ø§Ù„Ø­Ø²Ù…: bcryptjs, uuid, emailjs-com (Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ù… fetch Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±ÙŠØ¯ÙŠØ©). */


const STORAGE_KEYS = { PRODUCTS: "titan_products_v2", CART: "titan_cart_v2", ORDERS: "titan_orders_v2", ADMIN_ATTEMPTS: "titan_admin_attempts_v2", };

// Ù‡Ø´ Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± (PIN) Ù…Ø­ÙÙˆØ¸ Ù‡Ù†Ø§ Ø¹Ù„Ù‰ Ù‡ÙŠØ¦Ø© hash (Ù…Ø«Ø§Ù„): // unhashed PIN: 1122 const ADMIN_HASHED_PIN = bcrypt.hashSync("1122", 8); // in production: move to server/env

// Ù†Ù…ÙˆØ°Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¨Ø¯Ø¦ÙŠ const seedProducts = [ { id: 101, name: "Ø³Ø§Ø¹Ø© Ø±ÙˆÙ„ÙƒØ³ Ø¯Ø§ÙŠØªÙˆÙ†Ø§", price: 450000, category: "Ø³Ø§Ø¹Ø§Øª", stock: 5, img: "https://images.unsplash.com/photo-1523170335258-f5ed11844a49?w=800&q=80", colors: ["Ø°Ù‡Ø¨ÙŠ", "ÙØ¶ÙŠ"], sizes: ["40mm"] }, { id: 102, name: "Ø¹Ø·Ø± ØªÙˆÙ… ÙÙˆØ±Ø¯ Ø¹ÙˆØ¯", price: 210000, category: "Ø¹Ø·ÙˆØ±", stock: 12, img: "https://images.unsplash.com/photo-1594035910387-fea477942698?w=800&q=80", colors: ["Ø³ØªØ§Ù†Ø¯Ø±Ø¯"], sizes: ["50ml", "100ml"] }, { id: 103, name: "Ù†Ø§ÙŠÙƒÙŠ Ø¥ÙŠØ± Ø¬ÙˆØ±Ø¯Ù†", price: 85000, category: "Ø£Ø­Ø°ÙŠØ©", stock: 8, img: "https://images.unsplash.com/photo-1552346154-21d32810aba3?w=800&q=80", colors: ["Ø£Ø­Ù…Ø±", "Ø£Ø³ÙˆØ¯", "Ø£Ø¨ÙŠØ¶"], sizes: ["40", "41", "42", "43", "44"] }, { id: 104, name: "Ø³Ù…Ø§Ø¹Ø© Ø¢Ø¨Ù„ Ù…Ø§ÙƒØ³", price: 320000, category: "Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª", stock: 4, img: "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=800&q=80", colors: ["ÙØ¶ÙŠ", "Ø±Ù…Ø§Ø¯ÙŠ"], sizes: ["Standard"] }, ];

// Helper: persist/restore const usePersistedState = (key, initial) => { const [state, setState] = useState(() => { try { const raw = localStorage.getItem(key); return raw ? JSON.parse(raw) : initial; } catch (e) { return initial; } }); useEffect(() => { localStorage.setItem(key, JSON.stringify(state)); }, [key, state]); return [state, setState]; };

// Phone validation (Iraq-ish pattern, flexible) const validatePhone = (p) => { const cleaned = p.replace(/[^0-9+]/g, ""); return /^(+?964|0)?7\d{8}$/.test(cleaned); };

// CSV export utility const ordersToCSV = (orders) => { const header = ["Order ID", "Customer", "Phone", "City", "Address", "Items", "Total", "Status", "Timestamp"]; const rows = orders.map(o => [o.id, o.customer.name, o.customer.phone, o.customer.city, o.customer.addr, o.items, o.total, o.status, o.timestamp]); const csv = [header, ...rows].map(r => r.map(cell => "${(String(cell)).replace(/"/g, '""')}").join(",")).join("\n"); return "data:text/csv;charset=utf-8," + encodeURIComponent(csv); };

function App() { const [products, setProducts] = usePersistedState(STORAGE_KEYS.PRODUCTS, seedProducts); const [cart, setCart] = usePersistedState(STORAGE_KEYS.CART, []); const [orders, setOrders] = usePersistedState(STORAGE_KEYS.ORDERS, []);

// UI state const [query, setQuery] = useState(""); const [activeCat, setActiveCat] = useState("Ø§Ù„ÙƒÙ„"); const [selectedProduct, setSelectedProduct] = useState(null); const [isCartOpen, setCartOpen] = useState(false); const [isAdmin, setIsAdmin] = useState(false); const [adminLock, setAdminLock] = useState(false); const [adminAttempts, setAdminAttempts] = useState(() => { try { return JSON.parse(sessionStorage.getItem(STORAGE_KEYS.ADMIN_ATTEMPTS)) || { tries: 0, lockedUntil: null }; } catch(e){ return {tries:0, lockedUntil:null}; } });

useEffect(() => { sessionStorage.setItem(STORAGE_KEYS.ADMIN_ATTEMPTS, JSON.stringify(adminAttempts)); }, [adminAttempts]);

// Derived categories const categories = useMemo(() => ["Ø§Ù„ÙƒÙ„", ...Array.from(new Set(products.map(p => p.category)))], [products]);

// Filtered products const filtered = useMemo(() => { let list = products; if (activeCat !== "Ø§Ù„ÙƒÙ„") list = list.filter(p => p.category === activeCat); if (query.trim()) { const q = query.trim().toLowerCase(); list = list.filter(p => (p.name + " " + p.category).toLowerCase().includes(q)); } return list; }, [products, activeCat, query]);

// Cart helpers const addToCart = (product, { color=null, size=null, qty=1 } = {}) => { if (product.stock < qty) return alert("Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø£Ø¹Ù„Ù‰ Ù…Ù† Ø§Ù„Ù…ØªÙˆÙØ±"); setCart(prev => { const existing = prev.find(i => i.productId === product.id && i.color === color && i.size === size); if (existing) { return prev.map(i => i.cartId === existing.cartId ? { ...i, qty: i.qty + qty } : i); } return [{ cartId: uuidv4(), productId: product.id, name: product.name, price: product.price, img: product.img, color, size, qty }, ...prev]; }); // optimistic UI stock decrease (reserved) setProducts(prev => prev.map(p => p.id === product.id ? { ...p, stock: p.stock - qty } : p)); };

const updateCartQty = (cartId, qty) => { setCart(prev => prev.map(i => i.cartId === cartId ? { ...i, qty } : i)); };

const removeCartItem = (cartId) => { // restore stock const item = cart.find(i => i.cartId === cartId); if (item) setProducts(prev => prev.map(p => p.id === item.productId ? { ...p, stock: p.stock + item.qty } : p)); setCart(prev => prev.filter(i => i.cartId !== cartId)); };

const cartTotal = cart.reduce((a,b) => a + b.price * b.qty, 0);

// Checkout const submitOrder = async ({ name, phone, city, addr }) => { if (!name || !validatePhone(phone) || !addr) return alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª ØµØ­ÙŠØ­Ø©.");

const order = {
  id: "ORD-" + uuidv4().split('-')[0].toUpperCase(),
  customer: { name, phone, city, addr },
  items: cart.map(i => `${i.name} (${i.color||'-'}/${i.size||'-'} x${i.qty})`).join(' + '),
  total: cartTotal,
  status: 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
  timestamp: new Date().toLocaleString()
};

// try sending email via EmailJS or fallback to console
try {
  if (window.emailjs) {
    await window.emailjs.send("service_ga7ytjo", "template_lgvpsns", {
      order_id: order.id,
      from_name: name,
      message: `${order.items} | Total: ${order.total}`,
      phone: phone
    });
  } else {
    console.info("EmailJS not available - would send: ", order);
  }
} catch (e) {
  console.warn("Email send failed", e);
}

setOrders(prev => [order, ...prev]);
setCart([]);
alert("ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! Ø±Ù‚Ù… Ø§Ù„ØªØªØ¨Ø¹: " + order.id);
setCartOpen(false);

};

// Admin functions const tryAdminLogin = (pin) => { const now = Date.now(); if (adminAttempts.lockedUntil && now < adminAttempts.lockedUntil) return alert("Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ù‚ÙÙ„Ø© Ù…Ø¤Ù‚ØªÙ‹Ø§. Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹.");

if (bcrypt.compareSync(pin, ADMIN_HASHED_PIN)) {
  setIsAdmin(true);
  setAdminAttempts({ tries: 0, lockedUntil: null });
} else {
  const tries = (adminAttempts.tries || 0) + 1;
  let lockedUntil = null;
  if (tries >= 3) lockedUntil = now + 5 * 60 * 1000; // 5 minutes lock
  setAdminAttempts({ tries, lockedUntil });
  alert("Ø±Ù…Ø² Ø®Ø§Ø·Ø¦. Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: " + Math.max(0, 3 - tries));
}

};

const logoutAdmin = () => setIsAdmin(false);

const updateOrderStatus = (orderId, status) => { setOrders(prev => prev.map(o => o.id === orderId ? { ...o, status } : o)); };

const deleteOrder = (orderId) => { if (!confirm("Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠØŸ")) return; setOrders(prev => prev.filter(o => o.id !== orderId)); };

// PWA service worker registration helper (simple) useEffect(() => { if ('serviceWorker' in navigator) { navigator.serviceWorker?.register('/sw.js').catch(() => console.info('SW registration failed or not provided')); } }, []);

// Export CSV const exportOrdersCSV = () => { const href = ordersToCSV(orders); const a = document.createElement('a'); a.href = href; a.download = 'orders.csv'; a.click(); };

return ( <div dir="rtl" lang="ar" className="min-h-screen bg-gray-100 text-gray-800 antialiased"> <header className="bg-white shadow sticky top-0 z-40"> <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between"> <div className="flex items-center gap-3"> <div className="text-2xl font-black">TITAN<span className="text-yellow-600">.OS</span></div> <div className="text-sm text-gray-500">Cyberâ€‘Architecture Market</div> </div> <div className="flex items-center gap-3"> <input value={query} onChange={e=>setQuery(e.target.value)} placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬" className="px-3 py-2 border rounded-lg" /> <div className="relative"> <button onClick={()=>setCartOpen(true)} className="px-3 py-2 bg-black text-yellow-300 rounded-lg font-bold">Ø¹Ø±Ø¨Ø© ({cart.length})</button> </div> <div className="text-sm text-gray-600">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <b>{cartTotal.toLocaleString()} Ø¯.Ø¹</b></div> </div> </div> </header>

<main className="max-w-6xl mx-auto px-4 py-6">
    <section className="mb-4">
      <div className="flex items-center gap-2 overflow-x-auto">
        {categories.map(c => (
          <button key={c} onClick={()=>setActiveCat(c)} className={`px-4 py-2 rounded-full font-semibold ${activeCat===c? 'bg-black text-yellow-300' : 'bg-gray-200'}`}>{c}</button>
        ))}
      </div>
    </section>

    <section className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      {filtered.map(p => (
        <article key={p.id} className="bg-white rounded-2xl shadow p-3 hover:shadow-lg transition cursor-pointer" onClick={()=>setSelectedProduct(p)}>
          <div className="h-44 w-full overflow-hidden rounded-xl mb-3 bg-gray-50">
            <img src={p.img} alt={p.name} className="w-full h-full object-cover" />
          </div>
          <div className="flex justify-between items-start">
            <div>
              <h3 className="font-bold text-sm">{p.name}</h3>
              <div className="text-xs text-gray-500">{p.category}</div>
            </div>
            <div className="text-right">
              <div className="text-lg font-extrabold">{p.price.toLocaleString()} Ø¯.Ø¹</div>
              <div className={`text-xs mt-1 ${p.stock>0? 'text-green-600':'text-red-500'}`}>{p.stock>0? `Ù…ØªÙˆÙØ±: ${p.stock}`: 'Ù†ÙØ°Øª Ø§Ù„ÙƒÙ…ÙŠØ©'}</div>
            </div>
          </div>
        </article>
      ))}
    </section>

    <footer className="mt-8 text-center text-sm text-gray-500">Â© TITAN.OS â€” Ù†Ø³Ø®Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©. Ø§Ø·Ù„Ø¨ Ø±Ø¨Ø· Backend Ù„Ù„Ø¥Ù†ØªØ§Ø¬.</footer>
  </main>

  {/* Product Modal */}
  {selectedProduct && (
    <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center px-4" onClick={(e)=>{ if(e.target===e.currentTarget) setSelectedProduct(null); }}>
      <div className="bg-white max-w-xl w-full rounded-2xl p-6 shadow-lg">
        <div className="flex gap-4">
          <img src={selectedProduct.img} alt="" className="w-40 h-40 object-cover rounded-lg" />
          <div className="flex-1">
            <h2 className="font-extrabold text-lg">{selectedProduct.name}</h2>
            <div className="text-yellow-600 font-black text-xl mt-2">{selectedProduct.price.toLocaleString()} Ø¯.Ø¹</div>
            <div className="text-sm text-gray-500 mt-2">Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: {selectedProduct.stock}</div>

            <div className="mt-4">
              <label className="block text-sm font-semibold mb-1">Ø§Ù„Ù„ÙˆÙ†</label>
              <div className="flex gap-2 flex-wrap">
                {selectedProduct.colors.map(c => (
                  <button key={c} className="px-3 py-1 border rounded bg-gray-50" onClick={()=>{ /* noop, local selection below */ }}>{c}</button>
                ))}
              </div>
            </div>

            <div className="mt-3 flex items-center gap-3">
              <label className="text-sm font-semibold">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
              <QtySelector max={selectedProduct.stock} onAdd={(qty,color,size)=>{
                addToCart(selectedProduct, { qty, color, size });
                setSelectedProduct(null);
              }} />
            </div>

            <div className="mt-4">
              <button className="px-4 py-2 bg-black text-yellow-300 rounded-lg font-bold" onClick={()=>{ addToCart(selectedProduct, { qty:1 }); setSelectedProduct(null); }}>Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  )}

  {/* Cart Drawer */}
  <div className={`fixed top-0 ${isCartOpen? 'right-0':'-right-full'} h-full w-full sm:w-[420px] bg-white shadow-2xl z-50 transition-all`} style={{direction:'rtl'}}>
    <div className="p-4 flex items-center justify-between border-b">
      <h3 className="font-bold">Ø­Ù‚ÙŠØ¨Ø© Ø§Ù„ØªØ³ÙˆÙ‚ ({cart.length})</h3>
      <div className="flex items-center gap-2">
        <div className="text-sm">{cartTotal.toLocaleString()} Ø¯.Ø¹</div>
        <button className="px-3 py-1" onClick={()=>setCartOpen(false)}>Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
    <div className="p-4 overflow-auto h-[70vh]">
      {cart.length===0 && <div className="text-center text-gray-500">Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</div>}
      {cart.map(item => (
        <div key={item.cartId} className="flex items-center gap-3 border-b py-3">
          <img src={item.img} alt="" className="w-14 h-14 object-cover rounded" />
          <div className="flex-1">
            <div className="font-semibold">{item.name}</div>
            <div className="text-xs text-gray-500">{item.color||'-'} | {item.size||'-'}</div>
            <div className="mt-2 flex items-center gap-2">
              <QtySmall value={item.qty} onChange={(v)=>updateCartQty(item.cartId, v)} max={products.find(p=>p.id===item.productId)?.stock + item.qty || 99} />
              <div className="font-extrabold">{(item.price*item.qty).toLocaleString()} Ø¯.Ø¹</div>
            </div>
          </div>
          <div>
            <button className="text-red-500" onClick={()=>removeCartItem(item.cartId)}>Ø­Ø°Ù</button>
          </div>
        </div>
      ))}
    </div>
    <div className="p-4 border-t">
      <div className="flex justify-between items-center font-extrabold mb-3">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ <span>{cartTotal.toLocaleString()} Ø¯.Ø¹</span></div>
      <CheckoutForm onSubmit={submitOrder} disabled={cart.length===0} />
    </div>
  </div>

  {/* Admin Panel Modal */}
  <div className="fixed bottom-6 left-6 z-40">
    {!isAdmin ? (
      <button className="px-4 py-2 bg-white border rounded-lg shadow" onClick={()=>setAdminLock(true)}>Ù„ÙˆØ­Ø© Ø§Ù„Ø§Ø¯Ù…Ù†</button>
    ) : (
      <div className="bg-white p-3 rounded-lg shadow">
        <div className="flex gap-2 items-center"><b>Ù…Ø±Ø­Ø¨Ø§ØŒ Ø§Ù„Ù…Ø¯ÙŠØ±</b></div>
        <div className="mt-2 flex gap-2">
          <button className="px-3 py-1 bg-red-100 rounded" onClick={logoutAdmin}>Ø®Ø±ÙˆØ¬</button>
          <button className="px-3 py-1 bg-gray-100 rounded" onClick={()=>{ const href = ordersToCSV(orders); const a = document.createElement('a'); a.href=href; a.download='orders.csv'; a.click(); }}>ØªØµØ¯ÙŠØ± CSV</button>
        </div>
      </div>
    )}
  </div>

  {/* Admin Lock Dialog */}
  {adminLock && !isAdmin && (
    <div className="fixed inset-0 bg-black/60 z-50 flex items-center justify-center" onClick={(e)=>{ if(e.target===e.currentTarget) setAdminLock(false); }}>
      <div className="bg-white rounded p-6 w-full max-w-sm">
        <h3 className="font-bold mb-2">ğŸ” Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø§Ø¯Ù…Ù†</h3>
        <AdminLogin onCancel={()=>setAdminLock(false)} onLogin={(pin)=>{ tryAdminLogin(pin); setAdminLock(false); }} attempts={adminAttempts} />
      </div>
    </div>
  )}

  {/* Admin Dashboard overlay (simple) */}
  {isAdmin && (
    <div className="fixed inset-0 bg-black/40 z-40 p-8 overflow-auto">
      <div className="max-w-4xl mx-auto bg-white rounded p-6">
        <div className="flex justify-between items-center mb-4">
          <h2 className="font-extrabold">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… - Ø§Ù„Ø·Ù„Ø¨Ø§Øª ({orders.length})</h2>
          <div className="flex gap-2">
            <button className="px-3 py-1 bg-gray-100 rounded" onClick={()=>setIsAdmin(false)}>Ø¥ØºÙ„Ø§Ù‚</button>
            <button className="px-3 py-1 bg-green-100 rounded" onClick={exportOrdersCSV}>ØªØµØ¯ÙŠØ± CSV</button>
          </div>
        </div>
        <div>
          <table className="w-full text-sm">
            <thead className="text-right">
              <tr className="bg-gray-50"><th className="p-2">Order ID</th><th>Ø§Ù„Ø²Ø¨ÙˆÙ†</th><th>Ø§Ù„Ø¹Ù†Ø§ØµØ±</th><th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr>
            </thead>
            <tbody>
              {orders.map(o => (
                <tr key={o.id} className="border-b">
                  <td className="p-2">{o.id}<br/><small className="text-gray-400">{o.timestamp}</small></td>
                  <td>{o.customer.name}<br/><small>{o.customer.phone}</small></td>
                  <td>{o.items}</td>
                  <td className="font-bold">{o.total.toLocaleString()} Ø¯.Ø¹</td>
                  <td>
                    <select value={o.status} onChange={(e)=>updateOrderStatus(o.id, e.target.value)} className="border px-2 py-1 rounded">
                      <option>Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                      <option>ØªÙ… Ø§Ù„Ø´Ø­Ù†</option>
                      <option>ÙˆØ§ØµÙ„</option>
                      <option>Ù…Ù„ØºÙŠ</option>
                    </select>
                  </td>
                  <td><button className="text-red-500" onClick={()=>deleteOrder(o.id)}>Ø­Ø°Ù</button></td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  )}
</div>

); }

// Small reusable components function QtySelector({ max=99, onAdd }){ const [qty, setQty] = useState(1); const inc = ()=> setQty(q=> Math.min(max, q+1)); const dec = ()=> setQty(q=> Math.max(1, q-1)); return ( <div className="flex items-center gap-2"> <button onClick={dec} className="px-2 py-1 border rounded">âˆ’</button> <input value={qty} onChange={e=>setQty(Math.max(1, Number(e.target.value)||1))} className="w-14 text-center border rounded px-2 py-1" /> <button onClick={inc} className="px-2 py-1 border rounded">+</button> <button onClick={()=>onAdd(qty)} className="px-3 py-1 bg-black text-yellow-300 rounded">Ø¥Ø¶Ø§ÙØ©</button> </div> ); }

function QtySmall({ value, onChange, max=99 }){ return ( <div className="flex items-center gap-1"> <button onClick={()=>onChange(Math.max(1, value-1))} className="px-2 py-1 border rounded">âˆ’</button> <div className="px-3 py-1 border rounded">{value}</div> <button onClick={()=>onChange(Math.min(max, value+1))} className="px-2 py-1 border rounded">+</button> </div> ); }

function CheckoutForm({ onSubmit, disabled }){ const [name, setName] = useState(""); const [phone, setPhone] = useState(""); const [city, setCity] = useState("Ø¨ØºØ¯Ø§Ø¯"); const [addr, setAddr] = useState("");

return ( <div className="flex flex-col gap-2"> <input placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" value={name} onChange={e=>setName(e.target.value)} className="px-3 py-2 border rounded" /> <input placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" value={phone} onChange={e=>setPhone(e.target.value)} className="px-3 py-2 border rounded" /> <select value={city} onChange={e=>setCity(e.target.value)} className="px-3 py-2 border rounded"> <option>Ø¨ØºØ¯Ø§Ø¯</option><option>Ø§Ù„Ø¨ØµØ±Ø©</option><option>Ø£Ø±Ø¨ÙŠÙ„</option><option>Ø§Ù„Ù†Ø¬Ù</option><option>Ø§Ù„Ù…ÙˆØµÙ„</option> </select> <textarea placeholder="Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø© Ø¯Ø§Ù„Ø©..." value={addr} onChange={e=>setAddr(e.target.value)} className="px-3 py-2 border rounded" /> <button disabled={disabled} onClick={()=>onSubmit({ name, phone, city, addr })} className={px-4 py-2 rounded ${disabled? 'bg-gray-300':'bg-black text-yellow-300 font-bold'}}>ğŸš€ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button> </div> ); }

function AdminLogin({ onLogin, onCancel, attempts }){ const [pin, setPin] = useState(""); return ( <div> <input placeholder="Ø£Ø¯Ø®Ù„ PIN" value={pin} onChange={e=>setPin(e.target.value)} className="px-3 py-2 border rounded w-full mb-2" /> <div className="flex gap-2"> <button className="px-3 py-1 bg-black text-yellow-300 rounded" onClick={()=>onLogin(pin)}>Ø¯Ø®ÙˆÙ„</button> <button className="px-3 py-1 bg-gray-100 rounded" onClick={onCancel}>Ø¥Ù„ØºØ§Ø¡</button> </div> <div className="text-xs text-gray-500 mt-2">Ù…Ø­Ø§ÙˆÙ„Ø§Øª: {attempts.tries || 0} / 3</div> {attempts.lockedUntil && <div className="text-xs text-red-500">Ù…Ù‚ÙÙˆÙ„ Ø­ØªÙ‰ {new Date(attempts.lockedUntil).toLocaleTimeString()}</div>} </div> ); }

// Render to page (for local demo) const container = document.getElementById('root'); if (container) createRoot(container).render(<App />);

export default App;
