<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Elite Global Store | Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --main: #0a0a0a; --gold: #d4af37; --bg: #f0f2f5; --white: #ffffff; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; margin: 0; background: var(--bg); color: #333; -webkit-tap-highlight-color: transparent; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ */
        header { background: var(--main); color: var(--white); padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; position: sticky; top:0; z-index:1000; box-shadow: 0 4px 12px rgba(0,0,0,0.4); }
        .logo { font-size: 22px; font-weight: 900; letter-spacing: 2px; color: var(--gold); cursor: pointer; }
        
        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª */
        .categories { display: flex; gap: 10px; overflow-x: auto; padding: 15px; background: var(--white); scrollbar-width: none; border-bottom: 1px solid #ddd; }
        .cat-item { background: var(--bg); padding: 8px 18px; border-radius: 25px; white-space: nowrap; font-size: 14px; font-weight: 600; cursor: pointer; transition: 0.3s; }
        .cat-item.active { background: var(--main); color: var(--gold); }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .container { padding: 15px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(165px, 1fr)); gap: 15px; }
        .p-card { background: var(--white); border-radius: 20px; overflow: hidden; position: relative; border: 1px solid #eee; transition: transform 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.02); }
        .p-card:active { transform: scale(0.98); }
        .p-card img { width: 100%; height: 180px; object-fit: cover; }
        .p-info { padding: 12px; text-align: right; }
        .p-price { color: var(--main); font-weight: 900; font-size: 17px; margin-top: 5px; }
        
        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª */
        .btn { border: none; padding: 12px; border-radius: 12px; cursor: pointer; font-weight: 700; width: 100%; font-size: 15px; display: flex; justify-content: center; align-items: center; gap: 8px; }
        .btn-black { background: var(--main); color: white; }
        .btn-gold { background: var(--gold); color: black; }
        
        .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.85); z-index: 2000; align-items: center; justify-content: center; padding: 15px; backdrop-filter: blur(5px); }
        .modal-content { background: white; width: 100%; max-width: 420px; padding: 25px; border-radius: 25px; position: relative; animation: popUp 0.3s ease; }
        @keyframes popUp { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* Ø§Ù„Ø³Ù„Ø© */
        .cart-item { display: flex; gap: 15px; padding: 10px 0; border-bottom: 1px solid #eee; align-items: center; }
        .cart-item img { width: 60px; height: 60px; border-radius: 10px; object-fit: cover; }
        .qty-ctrl { display: flex; align-items: center; gap: 12px; background: #f8f9fa; padding: 5px 12px; border-radius: 10px; }
        
        input, select, textarea { width: 100%; padding: 14px; margin: 8px 0; border: 1px solid #ddd; border-radius: 12px; background: #fdfdfd; font-size: 16px; transition: 0.3s; }
        input:focus { border-color: var(--gold); box-shadow: 0 0 8px rgba(212, 175, 55, 0.2); }
    </style>
</head>
<body>

<div id="app">
    <header>
        <div class="logo" onclick="location.reload()">ELITE GLOBAL</div>
        <div style="display: flex; gap: 20px;">
            <i class="fa-solid fa-receipt" onclick="showPage('orders')" style="font-size: 20px; cursor: pointer;"></i>
            <div style="position: relative;" onclick="openCart()">
                <i class="fa-solid fa-cart-shopping" style="font-size: 20px; cursor: pointer;"></i>
                <span id="cart-count" style="position: absolute; top: -10px; right: -10px; background: var(--gold); color: black; font-size: 10px; padding: 2px 6px; border-radius: 50%; font-weight: bold;">0</span>
            </div>
            <i id="admin-icon" class="fa-solid fa-user-gear" onclick="showPage('admin')" style="display: none; color: var(--gold); cursor: pointer; font-size: 20px;"></i>
        </div>
    </header>

    <div id="home-page" class="page">
        <div class="categories" id="cat-list"></div>
        <div class="container">
            <div class="grid" id="product-grid"></div>
        </div>
    </div>

    <div id="admin-page" class="page" style="display:none; padding: 20px;">
        <h2 style="text-align: center;">Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØªØ¬Ø±</h2>
        <div style="background: white; padding: 20px; border-radius: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
            <input type="text" id="adm-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
            <input type="number" id="adm-price" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø±">
            <input type="text" id="adm-img" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬">
            <select id="adm-cat"><option>Ø³Ø§Ø¹Ø§Øª</option><option>Ø¹Ø·ÙˆØ±</option><option>Ù…Ù„Ø§Ø¨Ø³</option><option>Ø£Ø¬Ù‡Ø²Ø©</option></select>
            <button class="btn btn-gold" onclick="addNewProduct()"><i class="fa-solid fa-plus"></i> Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…Ø®Ø²Ù†</button>
        </div>
        <div id="inventory-list" style="margin-top: 20px;"></div>
    </div>

    <div id="cart-modal" class="modal">
        <div class="modal-content" id="cart-body"></div>
    </div>
    
    <div id="checkout-modal" class="modal">
        <div class="modal-content">
            <h3>ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ÙˆØ´Ø­Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h3>
            <input type="text" id="ship-name" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ">
            <input type="tel" id="ship-phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (07xxxxxxxxx)" maxlength="11">
            <select id="ship-city">
                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©...</option>
                <option>Ø¨ØºØ¯Ø§Ø¯</option><option>Ø§Ù„Ø¨ØµØ±Ø©</option><option>Ù†ÙŠÙ†ÙˆÙ‰</option><option>Ø£Ø±Ø¨ÙŠÙ„</option><option>Ø§Ù„Ù†Ø¬Ù</option>
                <option>ÙƒØ±Ø¨Ù„Ø§Ø¡</option><option>Ø°ÙŠ Ù‚Ø§Ø±</option><option>ÙƒØ±ÙƒÙˆÙƒ</option><option>Ø§Ù„Ø£Ù†Ø¨Ø§Ø±</option><option>Ø¨Ø§Ø¨Ù„</option>
                <option>Ø¯ÙŠØ§Ù„Ù‰</option><option>Ù…ÙŠØ³Ø§Ù†</option><option>Ø§Ù„Ø¯ÙŠÙˆØ§Ù†ÙŠØ©</option><option>ØµÙ„Ø§Ø­ Ø§Ù„Ø¯ÙŠÙ†</option><option>Ø¯Ù‡ÙˆÙƒ</option>
                <option>Ø§Ù„Ø³Ù„ÙŠÙ…Ø§Ù†ÙŠØ©</option><option>ÙˆØ§Ø³Ø·</option><option>Ø§Ù„Ù…Ø«Ù†Ù‰</option>
            </select>
            <input type="text" id="ship-address" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„ / Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø© Ø¯Ø§Ù„Ø©">
            <button class="btn btn-black" id="final-btn" onclick="sendOrder()"><i class="fa-solid fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
            <button class="btn" onclick="closeModals()" style="background: none;">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>
</div>

<script>
    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ©
    emailjs.init("YXDPYRNxazZ45eYWS");
    
    let state = {
        products: JSON.parse(localStorage.getItem('g_p')) || [
            {id: 1, name: "Ø³Ø§Ø¹Ø© Ø±ÙˆÙ„ÙƒØ³ Ø°Ù‡Ø¨ÙŠØ©", price: 250000, cat: "Ø³Ø§Ø¹Ø§Øª", img: "https://images.unsplash.com/photo-1542496658-e33a6d0d50f6?w=400", stock: true},
            {id: 2, name: "Ø¹Ø·Ø± Ù„ÙŠØ¬Ù†Ø¯ Ø¨Ù„Ùˆ", price: 85000, cat: "Ø¹Ø·ÙˆØ±", img: "https://images.unsplash.com/photo-1544467316-145c28d46924?w=400", stock: true},
            {id: 3, name: "Ø­Ø°Ø§Ø¡ Ø£Ø¯ÙŠØ¯Ø§Ø³ Ø±ÙŠØ§Ø¶ÙŠ", price: 65000, cat: "Ø£Ø­Ø°ÙŠØ©", img: "https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=400", stock: true}
        ],
        cart: JSON.parse(localStorage.getItem('g_c')) || [],
        user: JSON.parse(localStorage.getItem('g_u')) || null
    };

    function start() {
        if (!state.user) {
            let name = prompt("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Elite Global! Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù„Ù„Ø¨Ø¯Ø¡:");
            if (name) {
                state.user = { name, role: name === 'admin' ? 'admin' : 'user' };
                localStorage.setItem('g_u', JSON.stringify(state.user));
            }
        }
        if (state.user?.role === 'admin') document.getElementById('admin-icon').style.display = 'block';
        renderCats();
        renderProducts();
        updateCartCount();
    }

    function renderCats() {
        const cats = ["Ø§Ù„ÙƒÙ„", "Ø³Ø§Ø¹Ø§Øª", "Ø¹Ø·ÙˆØ±", "Ù…Ù„Ø§Ø¨Ø³", "Ø£Ø­Ø°ÙŠØ©"];
        document.getElementById('cat-list').innerHTML = cats.map(c => `<div class="cat-item" onclick="filterP('${c}', event)">${c}</div>`).join('');
    }

    function renderProducts(filter = "Ø§Ù„ÙƒÙ„") {
        const grid = document.getElementById('product-grid');
        grid.innerHTML = state.products
            .filter(p => filter === "Ø§Ù„ÙƒÙ„" || p.cat === filter)
            .map(p => `
            <div class="p-card">
                ${!p.stock ? '<div style="position:absolute; inset:0; background:rgba(255,255,255,0.7); display:flex; align-items:center; justify-content:center; color:red; font-weight:bold; z-index:10;">Ù†Ø§ÙØ°</div>' : ''}
                <img src="${p.img}">
                <div class="p-info">
                    <div style="font-weight:bold; height:40px; overflow:hidden;">${p.name}</div>
                    <div class="p-price">${p.price.toLocaleString()} Ø¯.Ø¹</div>
                    <button class="btn btn-black" style="margin-top:10px; padding:8px;" onclick="addToCart(${p.id})"><i class="fa-solid fa-plus"></i> Ø§Ø·Ù„Ø¨</button>
                </div>
            </div>`).join('');
    }

    function addToCart(id) {
        const p = state.products.find(x => x.id === id);
        if (!p.stock) return alert("Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ± Ø­Ø§Ù„ÙŠØ§Ù‹");
        const exists = state.cart.find(x => x.id === id);
        if (exists) exists.qty++; else state.cart.push({...p, qty: 1, cid: Date.now()});
        save(); updateCartCount();
    }

    function openCart() {
        if (state.cart.length === 0) return alert("Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª ÙØ§Ø±ØºØ©!");
        document.getElementById('cart-modal').style.display = 'flex';
        renderCartUI();
    }

    function renderCartUI() {
        const total = state.cart.reduce((s, i) => s + (i.price * i.qty), 0) + 5000;
        document.getElementById('cart-body').innerHTML = `
            <h3>ğŸ›’ Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</h3>
            <div style="max-height: 300px; overflow-y: auto;">
                ${state.cart.map(i => `
                    <div class="cart-item">
                        <img src="${i.img}">
                        <div style="flex:1">
                            <div style="font-weight:bold;">${i.name}</div>
                            <div class="qty-ctrl">
                                <span onclick="changeQty(${i.cid}, -1)">-</span>
                                <b>${i.qty}</b>
                                <span onclick="changeQty(${i.cid}, 1)">+</span>
                                <i class="fa-solid fa-trash" style="color:red; margin-right:auto" onclick="delItem(${i.cid})"></i>
                            </div>
                        </div>
                    </div>`).join('')}
            </div>
            <div style="margin-top:20px; font-weight:bold; font-size:18px;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total.toLocaleString()} Ø¯.Ø¹</div>
            <button class="btn btn-gold" style="margin-top:15px;" onclick="openCheckout()">Ø§Ù„ØªÙˆØ¬Ù‡ Ù„Ù„Ø¯ÙØ¹</button>
            <button class="btn" onclick="closeModals()" style="background:none;">Ø¥ØºÙ„Ø§Ù‚</button>`;
    }

    function changeQty(cid, val) {
        const item = state.cart.find(x => x.cid === cid);
        item.qty += val; if (item.qty < 1) return delItem(cid);
        save(); renderCartUI();
    }

    function openCheckout() {
        document.getElementById('cart-modal').style.display = 'none';
        document.getElementById('checkout-modal').style.display = 'flex';
    }

    function sendOrder() {
        const name = document.getElementById('ship-name').value;
        const phone = document.getElementById('ship-phone').value;
        const city = document.getElementById('ship-city').value;
        const addr = document.getElementById('ship-address').value;

        if (!name || phone.length < 11 || !city) return alert("ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„ØµØ­ÙŠØ­ ÙˆØ§Ù„Ù…Ø­Ø§ÙØ¸Ø©");

        const btn = document.getElementById('final-btn');
        btn.disabled = true; btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ£Ù…ÙŠÙ† ÙˆØ§Ù„Ø¥Ø±Ø³Ø§Ù„...";

        const itemsStr = state.cart.map(i => `${i.name} (Ø§Ù„Ø¹Ø¯Ø¯: ${i.qty})`).join(' , ');
        const total = state.cart.reduce((s, i) => s + (i.price * i.qty), 0) + 5000;

        emailjs.send("service_ga7ytjo", "template_lgvpsns", {
            from_name: name,
            phone: phone,
            address: `${city} - ${addr}`,
            message: `Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª: ${itemsStr}\nØ§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total.toLocaleString()} Ø¯.Ø¹`,
            title: "Ø·Ù„Ø¨ Ø¹Ø§Ù„Ù…ÙŠ Ø¬Ø¯ÙŠØ¯"
        }).then(() => {
            alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! Ø³Ù†ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ø§Ù‹.");
            state.cart = []; save(); location.reload();
        }, (err) => { alert("ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ØŒ Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ø§Ù‹."); btn.disabled = false; });
    }

    function showPage(p) {
        document.querySelectorAll('.page').forEach(x => x.style.display = 'none');
        document.getElementById(p + '-page').style.display = 'block';
        if (p === 'admin') renderAdmin();
    }

    function renderAdmin() {
        document.getElementById('inventory-list').innerHTML = state.products.map(p => `
            <div style="display:flex; justify-content:space-between; align-items:center; background:white; padding:10px; margin-top:5px; border-radius:10px;">
                <span>${p.name}</span>
                <div>
                    <button onclick="toggleStock(${p.id})" style="color:${p.stock?'green':'red'}">${p.stock?'Ù…ØªÙˆÙØ±':'Ù†Ø§ÙØ°'}</button>
                    <button onclick="deleteP(${p.id})" style="margin-right:10px; color:red;">Ø­Ø°Ù</button>
                </div>
            </div>`).join('');
    }

    function toggleStock(id) {
        const p = state.products.find(x => x.id === id);
        p.stock = !p.stock; save(); renderAdmin(); renderProducts();
    }

    function deleteP(id) {
        state.products = state.products.filter(x => x.id !== id);
        save(); renderAdmin(); renderProducts();
    }

    function addNewProduct() {
        const n = document.getElementById('adm-name').value;
        const p = document.getElementById('adm-price').value;
        if (!n || !p) return alert("Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©");
        state.products.unshift({ id: Date.now(), name: n, price: parseInt(p), cat: document.getElementById('adm-cat').value, img: document.getElementById('adm-img').value || 'https://via.placeholder.com/400', stock: true });
        save(); renderAdmin(); renderProducts();
    }

    function save() {
        localStorage.setItem('g_p', JSON.stringify(state.products));
        localStorage.setItem('g_c', JSON.stringify(state.cart));
    }
    
    function updateCartCount() { document.getElementById('cart-count').innerText = state.cart.length; }
    function closeModals() { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); }
    function delItem(cid) { state.cart = state.cart.filter(x => x.cid !== cid); save(); updateCartCount(); if (state.cart.length === 0) closeModals(); else renderCartUI(); }

    window.onload = start;
</script>
</body>
</html>
